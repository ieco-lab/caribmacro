<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bank Attributes • caribmacro</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/slate/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Bank Attributes">
<meta property="og:description" content="caribmacro">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">caribmacro</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="https://github.com/ieco-lab/caribmacro" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Contemporized IBT
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="divider">
    </li>
<li>
      <a href="../articles/010_ibt_data_calcs.html">Data Calculations</a>
    </li>
    <li>
      <a href="../articles/011_bank_attributes.html">Bank Attributes</a>
    </li>
    <li>
      <a href="../articles/020_ibt_sr_avgmod_std.html">Contemporized IBT Analysis</a>
    </li>
    <li class="divider">
  </li>
</ul>
</li>
<li class="dropdown-header">Island Saturation Rescaling</li>
<li class="dropdown-header">Beta Diversity</li>
<li class="dropdown-header">Shipping Networks &amp; IBT</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Misc R Code
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="divider">
    </li>
<li>
      <a href="../articles/900_functions.html">Functions</a>
    </li>
    <li>
      <a href="../articles/910_records_update.html">Sp Records Updates</a>
    </li>
    <li class="divider">
  </li>
</ul>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Bank Attributes</h1>
                        <h4 data-toc-skip class="author">Jason M.
Gleditsch<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>
</h4>
            
            <h4 data-toc-skip class="date">06 December 2022</h4>
      
      
      <div class="hidden name"><code>011_bank_attributes.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="aim-and-scope">Aim and Scope<a class="anchor" aria-label="anchor" href="#aim-and-scope"></a>
</h2>
<p>Here we calculate the geographic, landscape, and economic attributes
for island banks in the Caribbean Bioregion as delineated by Hedges et
al. (2019) and including Bermuda.</p>
<p>First we need to load in the <code>caribmacro</code> package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Project package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gledits2.github.io/caribmacro/" class="external-link">caribmacro</a></span><span class="op">)</span></span></code></pre></div>
<p>If you do not have this package installed, then run
<code><a href="https://devtools.r-lib.org/reference/load_all.html" class="external-link">devtools::load_all</a></code> in order to load all of the necessary
functions if you are running this code in the caribmacro R project in
the shared folder. If you are not, then see the functions vignette for
the Functions needed.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load all of the functions of the caribmacro package</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/load_all.html" class="external-link">load_all</a></span><span class="op">(</span><span class="st">"./"</span>, export_all <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Function needed ##</span></span>
<span><span class="co">#   'isolation'  -&gt; calculates the isolation metric(s)</span></span>
<span><span class="co">#   'factorize'  -&gt; turns character columns of a data frame into factors</span></span></code></pre></div>
<p>The other R packages needed for this are:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/" class="external-link">here</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://had.co.nz/reshape" class="external-link">reshape</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org" class="external-link">readr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/heliosdrm/pwr" class="external-link">pwr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Spatial Packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/rgeos/" class="external-link">rgeos</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Analytical Packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://factominer.free.fr" class="external-link">FactoMineR</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Diversity Database Packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/taxize/" class="external-link">taxize</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Phylogenetic Packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://ape-package.ird.fr/" class="external-link">ape</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://daijiang.github.io/phyr/" class="external-link">phyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Graphing Packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="bank-attributes">Bank Attributes<a class="anchor" aria-label="anchor" href="#bank-attributes"></a>
</h2>
<div class="section level3">
<h3 id="bank-geography">Bank Geography<a class="anchor" aria-label="anchor" href="#bank-geography"></a>
</h3>
<p>In order to determine the island bank (hereafter, bank) land area,
number of islands, and island spread, we need to load in the Caribbean
island and bank shapefiles from the ‘data_raw’ folder in the
‘caribmacro’ package.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># loading data</span></span>
<span><span class="va">carib.isl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">'data_raw'</span>, <span class="st">'gis'</span>, <span class="st">'Carib_Islands.shp'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">carib.bnk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">'data_raw'</span>, <span class="st">'gis'</span>, <span class="st">'Carib_Banks.shp'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The in order to be able to calculate the bank area, we need to
re-project the shapefiles into the Lambert Azimuthal Equal Area
projection centered in the Caribbean. Then, we must change the type of
object to a spatial object.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Re-project into Lambert Azimuthal Equal Area centered in the Caribbean</span></span>
<span><span class="va">carib.isl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform</a></span><span class="op">(</span><span class="va">carib.isl</span>, <span class="st">"+proj=laea +x_0=0 +y_0=0 +lon_0=-72 +lat_0=20"</span><span class="op">)</span></span>
<span><span class="va">carib.bnk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform</a></span><span class="op">(</span><span class="va">carib.bnk</span>, <span class="st">"+proj=laea +x_0=0 +y_0=0 +lon_0=-72 +lat_0=20"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Change 'carib.isl' and 'carib.bnk' to class 'Spatial'</span></span>
<span><span class="va">carib.isl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/as.html" class="external-link">as</a></span><span class="op">(</span><span class="va">carib.isl</span>, Class <span class="op">=</span> <span class="st">"Spatial"</span><span class="op">)</span></span>
<span><span class="va">carib.bnk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/as.html" class="external-link">as</a></span><span class="op">(</span><span class="va">carib.bnk</span>, Class <span class="op">=</span> <span class="st">"Spatial"</span><span class="op">)</span></span></code></pre></div>
<p>Before we calculate the land area of each bank lets create a maximum
convex polygon (MCP) around each bank in order to calculate the spread
of each bank’s islands.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bnk.mcp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rgeos/man/topo-unary-gConvexHull.html" class="external-link">gConvexHull</a></span><span class="op">(</span><span class="va">carib.bnk</span>, byid <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bnk.mcp.sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="va">bnk.mcp</span><span class="op">)</span></span>
<span><span class="va">bnk.mcp.sf</span><span class="op">$</span><span class="va">bank</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="va">carib.bnk</span><span class="op">)</span><span class="op">$</span><span class="va">bank</span></span></code></pre></div>
<p>Let’s now take a look at these MCPs to see if they look
appropriate.</p>
<p><img src="011_bank_attributes_files/figure-html/mcp%20plot-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Now we calculate the bank area using the Islands shapefile.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">carib.isl.sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="va">carib.isl</span><span class="op">)</span></span>
<span><span class="va">isl.area</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>bank <span class="op">=</span> <span class="va">carib.isl.sf</span><span class="op">$</span><span class="va">bank</span>, Area <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_measures.html" class="external-link">st_area</a></span><span class="op">(</span><span class="va">carib.isl.sf</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bnk.area</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">Area</span> <span class="op">~</span> <span class="va">bank</span>, data <span class="op">=</span> <span class="va">isl.area</span>, <span class="va">sum</span><span class="op">)</span></span></code></pre></div>
<p>With the bank area we then determine the area of the MCPs (i.e. area
of extent, hereafter AOE) and use that to calculate the island spread of
each bank by dividing the bank area by the AOE and subtracting that from
one. We also will determine the number of islands in each bank and
combine all of this into one data frame, ‘X’.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>bank <span class="op">=</span> <span class="va">bnk.mcp.sf</span><span class="op">$</span><span class="va">bank</span>, AOE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_measures.html" class="external-link">st_area</a></span><span class="op">(</span><span class="va">bnk.mcp.sf</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">bnk.area</span>, <span class="va">X</span>, by<span class="op">=</span><span class="st">'bank'</span>, all<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">X</span><span class="op">$</span><span class="va">Area</span> <span class="op">&lt;-</span> <span class="va">X</span><span class="op">$</span><span class="va">Area</span><span class="op">/</span><span class="fl">1000000</span> <span class="co">#divide by 1E6 to convert to km^2</span></span>
<span><span class="va">X</span><span class="op">$</span><span class="va">AOE</span> <span class="op">&lt;-</span> <span class="va">X</span><span class="op">$</span><span class="va">AOE</span><span class="op">/</span><span class="fl">1000000</span>   <span class="co">#divide by 1E6 to convert to km^2</span></span>
<span></span>
<span><span class="va">X</span><span class="op">$</span><span class="va">Spread</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="op">(</span><span class="va">X</span><span class="op">$</span><span class="va">Area</span><span class="op">/</span><span class="va">X</span><span class="op">$</span><span class="va">AOE</span><span class="op">)</span> <span class="co">#'1 - ' so large values = more spread</span></span>
<span></span>
<span><span class="va">isl.area</span><span class="op">$</span><span class="va">Number</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">X</span>, <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">Number</span> <span class="op">~</span> <span class="va">bank</span>, data <span class="op">=</span> <span class="va">isl.area</span>, <span class="va">sum</span><span class="op">)</span>, by<span class="op">=</span><span class="st">'bank'</span>, all<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Now let’s look at the distribution of the bank area and island spread
variables.</p>
<p><img src="011_bank_attributes_files/figure-html/area_spread%20dist-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="bank-landcover-and-elevation">Bank Landcover and Elevation<a class="anchor" aria-label="anchor" href="#bank-landcover-and-elevation"></a>
</h3>
<p>Now let’s start to incorporate other bank attributes into the bank
data for use in the analysis. Let’s start by loading in the bank
elevation and land cover data. This data was exported from Google Earth
Engine using the ecoEE module (Helmus et al 2020; JavaScript scripts can
be found at the project <a href="https://github.com/gledits2/caribmacro" class="external-link">GitHub page</a> or within
the <a href="earth_engine.html">Earth Engine</a> vignette). The bank
elevation data was extracted from a SRTM digital elevation model (<a href="http://srtm.csi.cgiar.org" class="external-link uri">http://srtm.csi.cgiar.org</a>), and the land cover data was
extracted from the MODIS Land Cover Type Yearly Global 500m data set
(DOI: 10.5067/MODIS/MCD12Q1.006) using the Annual International
Geosphere-Biosphere Programme (IGBP) classification. We then combine the
elevation data with the previously calculated bank geographic data, and
the land cover data to create a new ‘lndcvr’ data frame.</p>
<p>For the land cover we combine the “Cropland” and “Urban” values to
get percent anthropogenic land cover. Similarly, we combine
“Evr_Needle”, “Grassland”, “Wetland”, “Evr_Broad”, “Dec_Needle”,
“Dec_Broad”, “Mixed_For”, “C_Shrub”, “O_Shrub”, “W_Savanna”, and
“Savanna” to get percent green land cover (i.e. ‘natural’).
Additionally, pixels that were made up of mosaics of small-scale
cultivation 40-60% with natural tree, shrub, or herbaceous vegetation
were given the classification as “Crp_Nat”, half of which was added to
percent green cover and half added to anthropogenic land cover.</p>
<p>For small banks, the pixels may have been determined as permanent
wetland when they were actually urban due to the small area of the
landmass (i.e. the ocean made the pixel permanently inundated with
30-60% water cover). Because of this, we “ground-truthed” the data for
the smaller banks (<span class="math inline">\(\leq\)</span>
100km<sup>2</sup>) by looking at the most recent Google Earth images of
the bank and comparing with the raster data to see if pixels erroneously
determined as permanent wetland. If the pixel had mostly buildings in it
then the pixel was added to “Urban” and removed from “Wetland”. An
example of this is Bermuda which is considered almost entirely permanent
wetland when in fact most of the land area has urban development.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Bank Elevation</span></span>
<span><span class="va">elev</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">'data_raw'</span>, <span class="st">'IBT_Bank_Elevation_final.csv'</span><span class="op">)</span>, header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">elev</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">elev</span><span class="op">)</span> <span class="op">!=</span> <span class="st">'bank'</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">'DEM'</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">elev</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">elev</span><span class="op">)</span> <span class="op">!=</span> <span class="st">'bank'</span><span class="op">)</span><span class="op">]</span>, sep <span class="op">=</span> <span class="st">'.'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">elev</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'bank'</span>, <span class="st">'DEM.max'</span>, <span class="st">'DEM.mean'</span>, <span class="st">'DEM.sd'</span><span class="op">)</span><span class="op">]</span>, by <span class="op">=</span> <span class="st">'bank'</span>, all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">X</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">X</span><span class="op">$</span><span class="va">bank</span><span class="op">)</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># Bank land cover</span></span>
<span><span class="va">igb_lc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">'data_raw'</span>, <span class="st">'IBT_Landcover_IGBP_final.csv'</span><span class="op">)</span>, header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">igb_lc</span><span class="op">$</span><span class="va">anthro</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">igb_lc</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Cropland"</span>, <span class="st">"Urban"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">igb_lc</span><span class="op">$</span><span class="va">anthro</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">0.5</span> <span class="op">*</span> <span class="va">igb_lc</span><span class="op">[</span>, <span class="st">"Crp_Nat"</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="va">igb_lc</span><span class="op">$</span><span class="va">anthro</span></span>
<span></span>
<span><span class="va">igb_lc</span><span class="op">$</span><span class="va">green</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">igb_lc</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Evr_Needle"</span>, <span class="st">"Grassland"</span>, <span class="st">'Wetland'</span>, <span class="st">"Evr_Broad"</span>, <span class="st">"Dec_Needle"</span>, </span>
<span>                                    <span class="st">"Dec_Broad"</span>, <span class="st">"Mixed_For"</span>, <span class="st">"C_Shrub"</span>, <span class="st">"O_Shrub"</span>, </span>
<span>                                    <span class="st">"W_Savanna"</span>, <span class="st">"Savanna"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">igb_lc</span><span class="op">$</span><span class="va">green</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">0.5</span> <span class="op">*</span> <span class="va">igb_lc</span><span class="op">[</span>, <span class="st">"Crp_Nat"</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="va">igb_lc</span><span class="op">$</span><span class="va">green</span></span>
<span></span>
<span><span class="va">lndcvr</span> <span class="op">&lt;-</span> <span class="va">igb_lc</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'bank'</span>, <span class="st">'anthro'</span>, <span class="st">'green'</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">lndcvr</span> <span class="op">&lt;-</span> <span class="va">lndcvr</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">lndcvr</span><span class="op">$</span><span class="va">bank</span><span class="op">)</span>, <span class="op">]</span></span></code></pre></div>
<p>Let’s look at the distribution of the land cover variables as
well.</p>
<p><img src="011_bank_attributes_files/figure-html/lndcvr%20dist-1.png" width="672" style="display: block; margin: auto;"></p>
<pre><code><span><span class="co">## Banks with no land cover data: </span></span>
<span><span class="co">##  aves | hogsty reef | monito | pedro | serranilla</span></span></code></pre>
<p>We also should look at the distribution on the various elevation
distributions.</p>
<p><img src="011_bank_attributes_files/figure-html/elev%20dist-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="bank-isolation">Bank Isolation<a class="anchor" aria-label="anchor" href="#bank-isolation"></a>
</h3>
<p>Bank isolation was calculated in a similar way as Helmus (2014) (DOI:
10.1038/nature13739). For this we will use the distances from the
centroids of each bank, and then using that distance matrix calculate
the isolation metrics by determining the principle components from a
principle components anlysis (PCA) of selected square-root transformed
distances to to other banks and source(s).</p>
<p>For the distances between the banks we will be using the bank
centroids, so let’s load in the centroids and take a look at there
placement.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cent</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">'data_raw'</span>, <span class="st">'gis'</span>, <span class="st">'Centroids_Bank_Main.shp'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">map</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">'data_raw'</span>, <span class="st">'gis'</span>, <span class="st">'Carib_Banks_w_Mainland.shp'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="011_bank_attributes_files/figure-html/centroids%20plot-1.png" width="624" style="display: block; margin: auto;"></p>
<p>The placement of the centroids look good so now lets calculate the
distance matrix that will hold all of the distances between the
banks.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cent</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform</a></span><span class="op">(</span><span class="va">cent</span>, <span class="st">"+proj=aeqd +x_0=0 +y_0=0 +lon_0=-72 +lat_0=20"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cent.dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_measures.html" class="external-link">st_distance</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cent</span>, y <span class="op">=</span> <span class="va">cent</span>, by_element <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cent.dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">cent.dist</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">cent.dist</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">' '</span>, <span class="st">'.'</span>, <span class="va">cent</span><span class="op">$</span><span class="va">bank</span><span class="op">)</span></span>
<span><span class="va">cent.dist</span><span class="op">$</span><span class="va">bank</span> <span class="op">&lt;-</span> <span class="va">cent</span><span class="op">$</span><span class="va">bank</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">cent.dist</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">' '</span>, <span class="st">'.'</span>, <span class="va">cent.dist</span><span class="op">$</span><span class="va">bank</span><span class="op">)</span></span>
<span><span class="va">cent.dist</span> <span class="op">&lt;-</span> <span class="va">cent.dist</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">cent.dist</span><span class="op">$</span><span class="va">bank</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'bank'</span>, <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">cent.dist</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">cent.dist</span><span class="op">)</span> <span class="op">!=</span> <span class="st">'bank'</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">cent.dist</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">cent.dist</span><span class="op">[</span>, <span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">cent.dist</span><span class="op">[</span>, <span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>However, it makes more sense to use the shoreline of the mainland
instead of centroids. That would ensure that island banks such as
Trinidad are not considered isolated from the mainland even though it’s
centroid is one of the closest to the South American shoreline. To do
this we will have to load in another shapefile with the shorelines of
North America, Central America, and South America and find the distance
from all of the bank centroids to the the shoreline of the mainland.
Those distances then need to be merged with the centroid distance matrix
made above and the distance to the mainland centroids removed.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the shapefile for the mainland shoreline</span></span>
<span><span class="va">main.shor</span><span class="op">&lt;-</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">'data_raw'</span>, <span class="st">'gis'</span>, <span class="st">'Cont_Main_WGS_Merc.shp'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">main.shor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform</a></span><span class="op">(</span><span class="va">main.shor</span>, <span class="st">"+proj=aeqd +x_0=0 +y_0=0 +lon_0=-72 +lat_0=20"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dist.shor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_measures.html" class="external-link">st_distance</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cent</span>, y <span class="op">=</span> <span class="va">main.shor</span>, by_element <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dist.shor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">dist.shor</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dist.shor</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">' '</span>, <span class="st">'.'</span>, <span class="va">main.shor</span><span class="op">$</span><span class="va">Isl_Name</span><span class="op">)</span></span>
<span><span class="va">dist.shor</span><span class="op">$</span><span class="va">bank</span> <span class="op">&lt;-</span> <span class="va">cent</span><span class="op">$</span><span class="va">bank</span></span>
<span><span class="va">dist.shor</span> <span class="op">&lt;-</span> <span class="va">dist.shor</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">dist.shor</span><span class="op">$</span><span class="va">bank</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'bank'</span>, <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dist.shor</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dist.shor</span><span class="op">)</span> <span class="op">!=</span> <span class="st">'bank'</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">dist.shor</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">dist.shor</span><span class="op">[</span>, <span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">dist.shor</span><span class="op">[</span>, <span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">dist.shor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">cent.dist</span>, <span class="va">dist.shor</span>, by <span class="op">=</span> <span class="st">'bank'</span>, all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dist.shor</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">'.y'</span>, <span class="st">''</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dist.shor</span><span class="op">)</span>, fixed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">shor.dist</span> <span class="op">&lt;-</span> <span class="va">dist.shor</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">intersect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">cent.dist</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dist.shor</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>For the Caribbean herpetofauna, South America was the main source for
the immigration of species to the islands. However, work done with
<em>Anolis</em> lizards has shown that many of the <em>Anolis</em>
communities of the southern Greater Antilles and northern Lesser
Antilles actually came from Cuba and Hispanola. Both of these banks are
quite large being almost an order of magnitude greater in size than the
next largest bank and seemed to have acted as a source for many of the
surrounding islands. Therefore, in the same manner as the mainland, it
makes sense to measure distance to these banks as distance to the
shoreline of their main islands instead of their centroids.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the shapefile for the Cuba and Hispaniola shoreline</span></span>
<span><span class="va">sorc.shor</span><span class="op">&lt;-</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">'data_raw'</span>, <span class="st">'gis'</span>, <span class="st">'Cuba_Hisp_Shore.shp'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sorc.shor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform</a></span><span class="op">(</span><span class="va">sorc.shor</span>, <span class="st">"+proj=aeqd +x_0=0 +y_0=0 +lon_0=-72 +lat_0=20"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dist.sorc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_measures.html" class="external-link">st_distance</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cent</span>, y <span class="op">=</span> <span class="va">sorc.shor</span>, by_element <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dist.sorc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">dist.sorc</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dist.sorc</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">' '</span>, <span class="st">'.'</span>, <span class="va">sorc.shor</span><span class="op">$</span><span class="va">bank</span><span class="op">)</span></span>
<span><span class="va">dist.sorc</span><span class="op">$</span><span class="va">bank</span> <span class="op">&lt;-</span> <span class="va">cent</span><span class="op">$</span><span class="va">bank</span></span>
<span><span class="va">dist.sorc</span> <span class="op">&lt;-</span> <span class="va">dist.sorc</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">dist.sorc</span><span class="op">$</span><span class="va">bank</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'bank'</span>, <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dist.sorc</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dist.sorc</span><span class="op">)</span> <span class="op">!=</span> <span class="st">'bank'</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">dist.sorc</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">dist.sorc</span><span class="op">[</span>, <span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">dist.sorc</span><span class="op">[</span>, <span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">dist.sorc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">shor.dist</span>, <span class="va">dist.sorc</span>, by <span class="op">=</span> <span class="st">'bank'</span>, all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dist.sorc</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">'.y'</span>, <span class="st">''</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dist.sorc</span><span class="op">)</span>, fixed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">sorc.dist</span> <span class="op">&lt;-</span> <span class="va">dist.sorc</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">intersect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">cent.dist</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dist.sorc</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">sorc.dist</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">' '</span>, <span class="st">'.'</span>, <span class="va">sorc.dist</span><span class="op">$</span><span class="va">bank</span><span class="op">)</span></span>
<span><span class="va">dist</span> <span class="op">&lt;-</span> <span class="va">sorc.dist</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">sorc.dist</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">sorc.dist</span><span class="op">)</span> <span class="op">!=</span> <span class="st">'bank'</span><span class="op">)</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p>Now that we have the distances between each bank and the distances
between the banks and the mainland, we can calculate the isolation
metrics. We will do this by using the <code><a href="../reference/isolation.html">isolation()</a></code> function
in the ‘caribmacro’ package which calculates the isolation metrics in
the manner described above. For the calculation of island bank isolation
we will be using the square root transformed minimum distance to an
immigration source (Cuba, Hispaniola, and South and Central America), to
another bank (including the mainland), and to a bank of equal or larger
size.</p>
<p>We are including Central America as a possible source because the
island banks off the coast of Central America (e.g. Cozumel) have
herpetofaunal communities that have likely arose from the Central
American clades. Additionally, since our sources and the mainland areas
overlap quite a bit, we are not including the minimum distance to the
mainland as one of the distances used in the calculation of this
metric.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">main</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'central.america'</span>, <span class="st">'north.america'</span>, <span class="st">'south.america'</span><span class="op">)</span></span>
<span><span class="va">src</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'cuba'</span>, <span class="st">'hispaniola'</span>, <span class="st">'south.america'</span>, <span class="st">'central.america'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bnk.area</span><span class="op">$</span><span class="va">bank</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">' '</span>, <span class="st">'.'</span>, <span class="va">bnk.area</span><span class="op">$</span><span class="va">bank</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">iso</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/isolation.html">isolation</a></span><span class="op">(</span>dist <span class="op">=</span> <span class="va">dist</span>,</span>
<span>                             source <span class="op">=</span> <span class="va">src</span>,</span>
<span>                             main <span class="op">=</span> <span class="va">main</span>,</span>
<span>                             larger <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                             area <span class="op">=</span> <span class="va">bnk.area</span>,</span>
<span>                             min <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                             sum <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                             d.main <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                             export.dist <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    user  system elapsed </span></span>
<span><span class="co">##    0.26    0.02    0.28</span></span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Check the loadings and eigenvalues of the PCA</span></span>
<span><span class="va">iso</span><span class="op">[[</span><span class="st">'Variance'</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##     PC Eigenvalue   Cum_Var</span></span>
<span><span class="co">## 1 PC.1  2.0516521  68.38840</span></span>
<span><span class="co">## 2 PC.2  0.7671934  93.96152</span></span>
<span><span class="co">## 3 PC.3  0.1811545 100.00000</span></span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">iso</span><span class="op">[[</span><span class="st">'Loadings'</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##   Variable      PC.1       PC.2        PC.3</span></span>
<span><span class="co">## 1      min 0.9050670 -0.3070705  0.29421342</span></span>
<span><span class="co">## 2   larger 0.9255198 -0.2227234 -0.30627977</span></span>
<span><span class="co">## 3   source 0.6131223  0.7894906  0.02802892</span></span></code></pre>
<p>The loadings for PC1 suggest it represents overall isolation, and the
loadings for PC2 suggest it represents isolation from one of the main
immigration sources.</p>
<p>Let’s look at the banks’ isolation metrics (PC1 and PC2) to see if
they make sense.</p>
<p><img src="011_bank_attributes_files/figure-html/iso%20plots%201-1.png" width="768" style="display: block; margin: auto;"></p>
<p><img src="011_bank_attributes_files/figure-html/iso%20maps%201-1.png" width="768" style="display: block; margin: auto;"></p>
<p>From these plots, the metrics do seem to make overall sense. However,
there are clearly some outliers (Bermuda for PC1 and Cuba and Hispaniola
for PC2). Additionally, Bermuda, which should be the most isolated for
both PC1 and PC2, is considered less isolated from a source than most
(if not all) the Lesser Antilles.</p>
<p>Therefore, it may make sense to just use the actual distances (square
root transformed) as our metrics for isolation. This is especially true
since we are only using three distances in the PCA anyway. First let’s
see just how correlated all of the possible distances are so that we can
see if we will have any collinearity issues in our analyses.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">iso</span><span class="op">[[</span><span class="st">'Distances'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'sum'</span>, <span class="st">'min'</span>, <span class="st">'main'</span>, <span class="st">'source'</span>, <span class="st">'larger'</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##           sum   min   main source larger</span></span>
<span><span class="co">## sum     1.000 0.228 -0.554  0.022  0.087</span></span>
<span><span class="co">## min     0.228 1.000  0.213  0.321  0.816</span></span>
<span><span class="co">## main   -0.554 0.213  1.000  0.566  0.334</span></span>
<span><span class="co">## source  0.022 0.321  0.566  1.000  0.383</span></span>
<span><span class="co">## larger  0.087 0.816  0.334  0.383  1.000</span></span></code></pre>
<p>The only distances that have a correlation over 0.6 is the distance
to a larger bank and the distance to nearest bank. So we could use any
of the others and either one of the ones that are highly correlated.
Let’s select the distance to a source, nearest bank, and the mainland
for right now and see how these values are distribute across the
banks.</p>
<p><img src="011_bank_attributes_files/figure-html/iso%20plots%202-1.png" width="1152" style="display: block; margin: auto;"></p>
<p><img src="011_bank_attributes_files/figure-html/iso%20maps%202-1.png" width="768" style="display: block; margin: auto;"></p>
<p>From these plots we can see that these distances tell us exactly what
we want to show with our isolation metrics without any strange things
happening for particular island banks. Additionally, we can see that the
distance to nearest bank and distance to a source both approximately
mirror PC1 (r = 0.91) and PC2 (r = 0.79), respectively. That means that
if we run into issues where the slight correlation between our distances
muddies any relationship we see, we can always use the PCs as isolation
metrics.</p>
</div>
<div class="section level3">
<h3 id="bank-economic-data">Bank Economic Data<a class="anchor" aria-label="anchor" href="#bank-economic-data"></a>
</h3>
<p>Now we will read in the banks’ economic data. These data are the
number of shipment to and from various Caribbean banks as recorded by <a href="https://www.lloyds.com/" class="external-link">Lloyd’s of London</a> for 4 separate
years (1979, 1991, 2003, and 2015).</p>
<p>We will also be using population estimates for each bank from the
Gridded Population of the World Version 4.11 (DOI: 10.7927/H4JW8BX5).
The Gridded Population data set includes estimates of population counts
for 30 arc-second pixels for the years 2000, 2005, 2010, 2015, and 2020.
The estimates for the Caribbean banks were extracted using Google Earth
Engine (JavaScript scripts can be found at the project <a href="https://github.com/gledits2/caribmacro" class="external-link">GitHub page</a>). We then
will take the average of the five years of estimates and use that in our
analyses.</p>
<p>For these data we will assume that any <code>NA</code> values
represent zeros. In the dataset, an <code>NA</code> means that there was
no recorded visits to that particular bank by a vessel tracked by
Lloyd’s. Therefore, assuming that <code>NA</code> values represent zeros
is valid when only considering vessels tracked by by Lloyd’s. The
acceptability for of this for bank population may not be as good given
that some of the banks may have land areas less than a 30 arc-second
pixel, and therefore, no data was extracted for that bank. However,
given the size of these banks, it is likely that the permanent
populations of the banks are very small if not zero.</p>
<p>To determine the maximum number of ships for each bank we will have
to use another function created for the ‘caribmacro’ package. This
function is <code><a href="../reference/row_max.html">row_max()</a></code> and calculates the maximum value in
each row of a data frame.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bank_e</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">'data_raw'</span>, <span class="st">'IBT_Lloyd_Bank_Degree_v0.csv'</span><span class="op">)</span>, header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">bank_e</span> <span class="op">&lt;-</span> <span class="va">bank_e</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bank"</span>, <span class="st">"to_1979"</span>, <span class="st">"to_1991"</span>, <span class="st">"to_2003"</span>, <span class="st">"to_2015"</span>, <span class="st">"to_total"</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">bank_e</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">bank_e</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">bank_e</span><span class="op">[</span>, <span class="va">i</span><span class="op">]</span><span class="op">)</span>, <span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">bank_e</span><span class="op">$</span><span class="va">ships_avg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowMeans</a></span><span class="op">(</span><span class="va">bank_e</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"to_1979"</span>, <span class="st">"to_1991"</span>, <span class="st">"to_2003"</span>, <span class="st">"to_2015"</span><span class="op">)</span><span class="op">]</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">bank_e</span><span class="op">$</span><span class="va">ships_max</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/row_max.html">row_max</a></span><span class="op">(</span><span class="va">bank_e</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"to_1979"</span>, <span class="st">"to_1991"</span>, <span class="st">"to_2003"</span>, <span class="st">"to_2015"</span><span class="op">)</span><span class="op">]</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bank_e</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bank_e</span><span class="op">)</span> <span class="op">==</span> <span class="st">'to_total'</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">'ships'</span></span>
<span><span class="va">bank_e</span><span class="op">$</span><span class="va">bank</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">bank_e</span><span class="op">$</span><span class="va">bank</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">'data_raw'</span>, <span class="st">'IBT_Bank_Population_v0.csv'</span><span class="op">)</span>, header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bank_e</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">bank_e</span>, <span class="va">pop</span>, by <span class="op">=</span> <span class="st">'bank'</span>, all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">econ</span> <span class="op">&lt;-</span> <span class="va">bank_e</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'bank'</span>, <span class="st">'ships'</span>, <span class="st">'pop_avg'</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">bank_e</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'ships'</span>, <span class="st">'ships_avg'</span>, <span class="st">'ships_max'</span><span class="op">)</span><span class="op">]</span>, use <span class="op">=</span> <span class="st">"pairwise.complete.obs"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##               ships ships_avg ships_max</span></span>
<span><span class="co">## ships     1.0000000 1.0000000 0.9771492</span></span>
<span><span class="co">## ships_avg 1.0000000 1.0000000 0.9771492</span></span>
<span><span class="co">## ships_max 0.9771492 0.9771492 1.0000000</span></span></code></pre>
<p>Since the maximum, average, and total number of ships that visited
each bank during those four years are all correlated with each other we
will just use the total number of ships since it is a better
representation of the possibility of species introductions due to trade
in recent history.</p>
<p>Let’s look at the distribution of some of these variables.</p>
<p><img src="011_bank_attributes_files/figure-html/econ%20dist-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="bank-data">Bank Data<a class="anchor" aria-label="anchor" href="#bank-data"></a>
</h3>
<p>Now let’s combine all of the bank data into a single data frame.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">X</span><span class="op">$</span><span class="va">bank</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">' '</span>, <span class="st">'.'</span>, <span class="va">X</span><span class="op">$</span><span class="va">bank</span><span class="op">)</span></span>
<span><span class="va">bank_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">iso</span><span class="op">[[</span><span class="st">'Components'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'bank'</span>, <span class="st">'PC1'</span>, <span class="st">'PC2'</span><span class="op">)</span><span class="op">]</span>, by <span class="op">=</span> <span class="st">'bank'</span>, all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bank_dat</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bank_dat</span><span class="op">)</span> <span class="op">==</span> <span class="st">'PC1'</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">bank_dat</span><span class="op">)</span> <span class="op">==</span> <span class="st">'PC2'</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'iso.PC1'</span>, <span class="st">'iso.PC2'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bank_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">bank_dat</span>, <span class="va">iso</span><span class="op">[[</span><span class="st">'Distances'</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'bank'</span>, <span class="st">'min'</span>, <span class="st">'main'</span>, <span class="st">'source'</span><span class="op">)</span><span class="op">]</span>, by <span class="op">=</span> <span class="st">'bank'</span>, all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lndcvr</span><span class="op">$</span><span class="va">bank</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">' '</span>, <span class="st">'.'</span>, <span class="va">lndcvr</span><span class="op">$</span><span class="va">bank</span><span class="op">)</span></span>
<span><span class="va">bank_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">bank_dat</span>, <span class="va">lndcvr</span>, by <span class="op">=</span> <span class="st">'bank'</span>, all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">econ</span><span class="op">$</span><span class="va">bank</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">' '</span>, <span class="st">'.'</span>, <span class="va">econ</span><span class="op">$</span><span class="va">bank</span><span class="op">)</span></span>
<span><span class="va">bank_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">bank_dat</span>, <span class="va">econ</span>, by <span class="op">=</span> <span class="st">'bank'</span>, all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>The <code>bank_dat</code> data frame now holds all of the data we may
need for the island biogeographic analysis and needs to be exported to
the ‘data_out’ folder. Additionally, we should export the information of
the isolation PCAs to the ‘supp_info’ folder in the ‘data_out’ folder.
Once these data are exported, we can then remove the objects loaded into
R for the determination of the bank attributes.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">bank_dat</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">'data_out'</span>, <span class="st">'IBT_Bank_Data.csv'</span><span class="op">)</span>, row.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">iso</span><span class="op">[[</span><span class="st">'Variance'</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">'data_out'</span>, <span class="st">'supp_info'</span>, <span class="st">'IBT_ISO_PCA_Var.csv'</span><span class="op">)</span>, row.names<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span><span class="va">iso</span><span class="op">[[</span><span class="st">'Loadings'</span><span class="op">]</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">'data_out'</span>, <span class="st">'supp_info'</span>, <span class="st">'IBT_ISO_PCA_Load.csv'</span><span class="op">)</span>, row.names<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="footnotes footnotes-end-of-document">
<hr>
<ol>
<li id="fn1"><p>Temple University, <a href="mailto:jmg5214@gmail.com" class="email">jmg5214@gmail.com</a><a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Jason M. Gleditsch, Matthew R. Helmus, Jocelyn E. Behm.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
